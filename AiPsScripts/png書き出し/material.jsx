#target illustrator function doAI() {           var doc = app.activeDocument;          var count = doc.pathItems.length;          doc.selection = null;           doc.activate();            doc.pathItems[0].selected = true;           app.redraw();           app.copy();          sendBT( 'photoshop', doPS, 3, i );          BridgeTalk.bringToFront( 'illustrator'  ); // No work - can remove          var f = File( BridgeTalk.getAppPath( 'illustrator' ) );           if ( f.exists ) f.execute(); // No work - can remove           doc.selection = null;           doc.activate(); // No work          app.redraw(); // No work          // Now we'll get app focus…!!!          //lastResort(); // Only as modal dialog type          alert( 'Done Path ' + i ); // Is modal dialog }; doAI( );  function lastResort() {            var win = new Window( 'dialog', 'hello…' );           win.preferredSize = [ 100, 50 ];           win.show();           win.hide();           win.close( 0 ); // This don't work either? }; function doPS( pathName ) {            var desc = new ActionDescriptor();           desc.putClass( charIDToTypeID( 'As  ' ), charIDToTypeID( 'Path' ) );           executeAction( charIDToTypeID( 'past' ), desc, DialogModes.NO );           var newPath = app.activeDocument.pathItems.getByName( 'Work Path' ).name = pathName;          app.activeDocument.pathItems.getByName( pathName ).deselect();           return 'Oh bugger not again';  }; function sendBT( tarapp, script, delay, name ) {      BridgeTalk.bringToFront( tarapp ); // Works for PS!!!     var result = null, bt = new BridgeTalk();     bt.headers.muppet = 'animal';     bt.body = script.toString() + '\r' + script.name + '( ' + name + ' );';          //$.write( bt.body );    bt.target = tarapp;    bt.timeout = delay;    bt.onError = function( btErr ) { result = btErr.body };    bt.onResult = function( btRes ) { result = btRes.body  };    bt.onTimeout = function( btOut ) { result = btOut.body  };     bt.send( delay );    //while ( result == null ) { $.sleep( 100 ), bt.pump() };    return result; };