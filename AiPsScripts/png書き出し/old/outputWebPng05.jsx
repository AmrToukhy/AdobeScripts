/*  outputWebPng.jsx ver 0.4    ##画像をphotoshop経由でweb吐き出しする。    update : 2012/12/10  author : ishiyama@sirok.co.jp           http://takahiro.me  ©2012 SIROK, Inc. All Rights Reserved.   */#target 'illustrator'var docObj = app.activeDocument; //ファイル情報取得var selObj = docObj.selection;var targetName = selObj.name;var selwidth = parseInt(selObj.width);var selheight = parseInt(selObj.height);app.copy();/*photoshopConnection*/var sendPSD = function(FN, obj) {      var bt=new BridgeTalk();      bt.target = 'photoshop' ;      bt.body = uneval(FN)+'('+uneval(obj)+')';      bt.onResult= function(resObj){          $.writeln( eval(resObj.body) );      }    bt.onTimeout = function(resObj){      alert('タイムアウトになりました。');    }    bt.onError = function(resObj){alert( resObj.body + " (" + resObj.headers ["Error-Code"] + ")" );};    bt.send();  }  //Photoshopで実行する関数function openPsd(obj) {    $.sleep(5);    obj.start();    $.writeln(obj.data);        app.documents.add(300, 300, 72, "Merged Samples", NewDocumentMode.RGB, DocumentFill.TRANSPARENT, 1);    app.activeDocument.paste();        return true; }$.writeln(selwidth + selheight + targetName);var sendObj = {};sendObj.start = function(){$.writeln ('INFO : Photoshop ACCESS!');};sendObj.data = {width:selwidth, height:selheight, name:targetName};sendPSD(openPsd, sendObj); //BridgeTalk送信部へ function alertObj(obj){    var properties = '';    for (var prop in obj){        properties += prop + "=" + obj[prop] + "\n";    }    alert(properties);};