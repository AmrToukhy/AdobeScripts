/*  outputWebPng.jsx ver 0.4    ##画像をphotoshop経由でweb吐き出しする。    update : 2012/12/10  author : ishiyama@sirok.co.jp           http://takahiro.me  ©2012 SIROK, Inc. All Rights Reserved.   */#target "illustrator";//編集中のファイル情報の取得docObj = app.activeDocument; //ファイル情報取得selObj = docObj.selection;targetName = selObj.name;selwidth = parseInt(selObj.width);selheight = parseInt(selObj.height);//$.writeln(selObj.height); //cpObj = app.copy();//クリップボードにコピーarrObj = [targetName,selwidth,selheight];brid//$.writeln(arrObj[1]);var bt = new BridgeTalk();bt.target = "Photoshop";//on photoshopbt.body = uneval(function(val){ val = eval(val);alert(val);$.wirteln(val);newDocument = documents.add(val[1],val[2], 72, val[0], NewDocumentMode.RGB, DocumentFill.TRANSPARENT, 1);newDocument.paste();})+'\('+arrObj.toSource();+'\);';bt.onResult = function(resObj) {Value = eval(resObj.body);$.writeln('RES : '+ Value);};bt.onTimeout = function(resObj){$.writeln('INFO : タイムアウトになりました。');};bt.onError = function(resObj){$.writeln('ERR : '+ resObj.headers ["Error-Code"] );};bt.send(60);//with TimeOut$.writeln(bt);//デバッグfunction alertObj(obj) {    var properties = '';    for (var prop in obj){        properties += prop + "=" + obj[prop] + "\n";    }    alert(properties);}