/*  outputWebPng.jsx ver 0.4    ##画像をphotoshop経由でweb吐き出しする。    update : 2012/12/10  author : ishiyama@sirok.co.jp           http://takahiro.me  ©2012 SIROK, Inc. All Rights Reserved.   */#target 'illustrator'function main(){    //編集中のファイル情報の取得  var docObj = app.activeDocument; //ファイル情報取得  var selObj = docObj.selection;  var cpObj = app.copy();  num = "132";  var bt = new BridgeTalk();  bt.target = "Photoshop";  //on photoshop  bt.body = uneval(function(val){     val = eval(val);     //alert(val);    preferences.rulerUnits = Units.PIXELS;    if (activeDocument.resolution !== 72) {      alert("解像度が72ppiではありません。「編集＞画像解像度」から解像度 72 pixel/inch にしてください。");    };    var mergedDoc = app.documents.add(10,10, 72, "Merged Samples", NewDocumentMode.RGB, DocumentFill.TRANSPARENT, 1);    app.paste();    return 0;  })+"("+['A'].toSource()+");";  bt.onResult = function(resObj) {        Value = eval(resObj.body);    $.writeln('RES : '+ Value);  };  bt.onTimeout = function(resObj){    $.writeln('INFO : タイムアウトになりました。');  };  bt.onError = function(resObj){    $.writeln('ERR : '+ resObj.headers ["Error-Code"] );  };  bt.send(30);//with TimeOut  alertObj(bt);    }/* fin main *///ドキュメントが開かれているかどうか判別if (app.documents.length == 0){}else main();//デバッグfunction alertObj(obj) {    var properties = '';    for (var prop in obj){        properties += prop + "=" + obj[prop] + "\n";    }    alert(properties);}