/*    Ctrls2PNG.jsx        ctrl+sでPNG画像をpngフォルダに自動吐き出し for MacPhotoshop    version: 0.9            Author : Takahiro Isihiyama    Mail : ishiyama@sirok.co.jp        導入方法:     1:スクリプトをhogehoge.jsxとして保存    2:Applications/Adobe Photoshop CS5.1/Presets/Scripts/ に移動    3:photoshopの キーボードショートカットのCTRL+S に割り当て        !ver0.9 bugReport!    **ドキュメントを保存してないとエラーが出ますが、ドキュメント保存をしていれば正常に動きます**   */#target photoshop//ドキュメントが開かれているかどうか判別if (app.documents.length == 0){	//ドキュメントが開かれていない場合処理なし}else{   main();}  /****************/function main(){    //編集中のファイル情報の取得  var docObj = activeDocument; //ファイル情報取得    //flag = docObj.saved;//ドキュメントが保存されているかどうか  //if(flag == true){      var docPath = docObj.path; //ファイルパス    var docName = docObj.name; //ファイル名    var date = dateClass(); //現在時刻の取得    publishPng(date, docPath, docName);//PNGパブリッシュ        //上書き保存    docObj.save();  //}  return 0;}/* fin main *///現在時刻の取得function dateClass(){    dTbl = new Array("日","月","火","水","木","金","土");  dObj = new Date();   while((new Date()).getTime() < dObj.getTime() + 1000*5){ //timeOut5秒      //日時の振り分け      year = dObj.getYear();      year2 = (year < 2000) ? year + 1900 : year;      month = dObj.getMonth() + 1;      day = dObj.getDate();      alert(day);      day2 = dTbl[day];      h = dObj.getHours();      m = dObj.getMinutes();      s = dObj.getSeconds();            //alert(year2 + "年" + month +"月" + day +"日"+"("+day2+")"+ h+"時"+m+"分"+s+"秒");      //new Date()の元データを保持      dateRaw = year2+"-"+month+"-"+day+"-"+h+"h"+m+"m"+s+"s";      break;  }  return dateRaw;}/* fin dateClass *///png保存function publishPng(date, docPath, docName){  folderName = docPath +"\/png\/";  folderObj = new Folder (folderName);  flag = folderObj.exists; //フォルダの有無  if(flag == false){   folderObj.create(); //フォルダがない場合にフォルダを作成  }  //フォルダが存在している場合  fileName = docName.slice(0,-4) + "\_" + date;  filePath = folderName + fileName + ".png";  //alert(filePath);  fileObj = new File(filePath);  pngOpt = new PNGSaveOptions();  pngOpt.interlaced = false; //インタレースなし  activeDocument.saveAs(fileObj, pngOpt, true, Extension.LOWERCASE);}/* fin publishPng */