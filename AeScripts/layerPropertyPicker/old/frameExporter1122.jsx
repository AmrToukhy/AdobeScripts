/*  frameInfoExporter.jsx ver  アニメーショントランスフォーム情報の抜き出し  #親子関係が有る場合、親レイヤーから開始位置です    update : 2012/11/22  author : ishiyama@sirok.co.jp           http://takahiro.me  ©2012 SIROK,Inc. All Rights Reserved.   */#target 'aftereffects'/* frameInfoExporter.jsx */function frameInfoExporter(){    $.writeln(debugMessage[0] + "frameInfoExporter.jsx");//処理スタート  //global  //active.composition  frameInfoExporter.comp = app.project.activeItem;  //selected.layers  frameInfoExporter.layers = app.project.activeItem.selectedLayers;  //notselected  if(frameInfoExporter.layers.length < 0) return alert("書き出しに必要なレイヤーを選択してください");    /* write property method */  frameInfoExporter.writeProp = function(layObj, propName)  {    //コンポジションのフレームレート、    //対象のレイヤープロパティ、    //ワークエリアの情報を宣言    fps = 1 / frameRate;    tmpObj = layObj.property(propName);        $.writeln("\nPropartyName : " + propName);    frameInfoExporter.fileObj.writeln("\nPropartyName : " + propName);    for(i = workAreaIn; i < workAreaOut; i+=fps)    {      n = tmpObj.valueAtTime(i, false);      $.writeln(n);      frameInfoExporter.fileObj.writeln(n);    }    };  /*write property method fin*/  /*write CompoInfo Method*/  frameInfoExporter.writeCompoInfo = function(){      selComp  = frameInfoExporter.comp;      compName = selComp.name;      compWidth = selComp.width;      compHeight = selComp.height;      frameRate = selComp.frameRate;      workAreaIn  = selComp.workAreaStart;      workAreaOut = selComp.workAreaDuration;            $.writeln("\ncompName : " + compName);      $.writeln("\ncompWidth : " + compWidth);      $.writeln("\ncompHeight : " + compHeight);      $.writeln("\nframeRate : " + frameRate);      $.writeln("\nworkAreaIn : " + workAreaIn);      $.writeln("\nworkAreaOut : " + workAreaOut);      //frameInfoExporter.fileObj.writeln(n);      return;  }  frameInfoExporter.writeCompoInfo();    /*write CompoInfo Method fin*/  //fileObj  frameInfoExporter.fileObj = File.saveDialog("保存するテキストファイル名を入れて下さい","*.txt");    if (!frameInfoExporter.fileObj) return $.writeln(debugMessage[3]);  var flag = frameInfoExporter.fileObj.open("w","txt","");  if (!flag) return $.writeln(debugMessage[3]);        //情報の取得  var selectLayTotal = frameInfoExporter.layers.length;  for (l=0; l < selectLayTotal; l++)  {    selectLayObj = frameInfoExporter.layers[l];    //親レイヤーが無い場合はNull    //if(selectLayObj.parent.name != null) parentLayerName = selectLayObj.parent.name;        $.writeln(debugMessage[2]);    $.writeln("LayerName : " + selectLayObj.name);    //テキストファイル    frameInfoExporter.fileObj.writeln("LayerName : " + selectLayObj.name);     frameInfoExporter.writeProp(selectLayObj, "position");    frameInfoExporter.writeProp(selectLayObj, "anchorPoint");    frameInfoExporter.writeProp(selectLayObj, "scale");    frameInfoExporter.writeProp(selectLayObj, "rotation");    //frameInfoExporter.writeProp(selectLayObj, "opacity");  }  frameInfoExporter.fileObj.close();    //通知  alert(compName + "の情報を保存しました");  $.writeln(compName + "の情報を保存しました");  $.writeln(debugMessage[1])  return $.writeln(debugMessage[1]);}//debugvar debugMessage = [  "INFO : スクリプト開始 ",  "INFO : スクリプト終了 ",  "//========================================",  "INFO : 何らかの理由でファイルが作成できませんでした。"];//mainframeInfoExporter();function alertObj(obj) {    var properties = '';    for (var prop in obj){        properties += prop + "=" + obj[prop] + "\n";    }    alert(properties);}