/*  frameInfoExporter.jsx ver0.8   アニメーション情報の抜き出し(トランスフォームのみ)    update : 2012/11/21  author : ishiyama@sirok.co.jp           http://takahiro.me  ©2012 SIROK,Inc. All Rights Reserved.   */#target 'aftereffects'/* frameInfoExporter.jsx */function frameInfoExporter(){    $.writeln(debugMassage[0] + "frameInfoExporter.jsx");//処理スタート  //global  //active.composition  frameInfoExporter.comp = app.project.activeItem;  //selected.layers  frameInfoExporter.layers = app.project.activeItem.selectedLayers;      alert(frameInfoExporter.comp.width);   /* writeProp Method */  frameInfoExporter.writeProp = function(layObj, propName)  {     //コンポジションのフレームレート、    //対象のレイヤープロパティ、    //ワークエリアの情報を宣言    var fps = 1 / frameInfoExporter.comp.frameRate;    var tmpObj = layObj.property(propName);    var workAreaIn = frameInfoExporter.comp.workAreaStart;    var workAreaOut = frameInfoExporter.comp.workAreaDuration;    var compWidth = frameInfoExporter.comp.width / 2;    //var layIn = layObj.inPoint;    //var layOut = layObj.outPoint;        $.writeln("\n#"+layObj.name+", "+propName);    for(i = workAreaIn; i < workAreaOut; i+=fps)    {      n = tmpObj.valueAtTime(i, false);      //if(propName=="position") n.x -= compWidth;      $.writeln(n);      frameInfoExporter.fileObj.writeln(n);    }    return;  };/*writeProp Method fin*/  //fileObj  frameInfoExporter.fileObj = File.saveDialog("保存するテキストファイル名を入れて下さい","*.txt");    if (!frameInfoExporter.fileObj) return $.writeln(debugMassage[3]);  var flag = frameInfoExporter.fileObj.open("w","txt","");  if (!flag) return $.writeln(debugMassage[3]);  //取得  var selectLayTotal = frameInfoExporter.layers.length;  for (var i=0; i<selectLayTotal; i++)  {    selectLayObj = frameInfoExporter.layers[i];    frameInfoExporter.writeProp(selectLayObj, "position");    frameInfoExporter.writeProp(selectLayObj, "anchorPoint");    frameInfoExporter.writeProp(selectLayObj, "scale");    frameInfoExporter.writeProp(selectLayObj, "rotation");    //frameInfoExporter.writeProp(selectLayObj, "opacity");  }  frameInfoExporter.fileObj.close();    //通知  alert(frameInfoExporter.comp.name + "の情報を保存しました");  return $.writeln(debugMassage[1]);}//mainframeInfoExporter();//debugvar debugMassage = [  "INFO : スクリプト開始 ",  "INFO : スクリプト終了 ",  "//========================================",  "INFO : 何らかの理由でファイルが作成できませんでした。"];function alertObj(obj) {    var properties = '';    for (var prop in obj){        properties += prop + "=" + obj[prop] + "\n";    }    alert(properties);}