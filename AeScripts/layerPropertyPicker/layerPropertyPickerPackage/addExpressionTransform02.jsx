/*  addExpressionTransform.jsx ver 1.0    ##プレビューアバターの名前を参照したExpressionを書き出す    update : 2012/12/04  author : ishiyama@sirok.co.jp           http://takahiro.me  ©2012 SIROK, Inc. All Rights Reserved.   */#target 'aftereffects';debugLog("start");/* addExpressionTransform.jsx */function addExpressionTransform(){      selLeyers = app.project.activeItem.selectedLayers;    var selLayTotal = selLeyers.length;  if(selLayTotal < 0) return alert("書き出しに必要なレイヤーを選択してください");   for (l=0; l < selLayTotal; l++)  {     var selectObj = app.project.activeItem.selectedLayers[l];   var layName = String(selectObj.name);   debugLog(layName);     /*write expression*/   //previewComp = pC;    selectObj.anchorPoint.expression = "var pC=String(comp('BaseAvatar_BONE').layer(1).text.sourceText);comp(pC).layer('" + layName + "').transform.anchorPoint;";    selectObj.transform.xPosition.expression = "var pC=String(comp('BaseAvatar_BONE').layer(1).text.sourceText);comp(pC).layer('"+layName+"').transform.xPosition;";    selectObj.transform.yPosition.expression = "var pC=String(comp('BaseAvatar_BONE').layer(1).text.sourceText);comp(pC).layer('"+layName+"').transform.yPosition;";    selectObj.scale.expression = "var pC = String(comp('BaseAvatar_BONE').layer(1).text.sourceText);comp(pC).layer('"+layName+"').transform.scale;";    selectObj.rotation.expression = "var pC = String(comp('BaseAvatar_BONE').layer(1).text.sourceText);comp(pC).layer('"+layName+"').transform.rotation;";    //selectObj.opacity.expression = "var pC = String(comp('BaseAvatar_BONE').layer(1).text.sourceText);comp(pC).layer('"+layName+"').transform.opacity;";    selectObj.opacity.expression = "";//プロパティを削除  }  return debugLog("fin");}//addExpressionTransform();function debugLog(obj){  $.writeln(obj);}function alertObj(obj) {    var properties = '';    for (var prop in obj){        properties += prop + "=" + obj[prop] + "\n";    }    alert(properties);}